<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="formula_base_carnicos_template">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <div class="page">
                    <div style="text-align:left;color:black!important;">
                        <div class="row">
                            <div class="col">
                                <table width="100%">
                                    <tr>
                                        <th class="table-active" colspan="8" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:14px;vertical-align:middle; padding:2px">
                                          <strong>F칩rmula base c치rnicos: </strong> <span t-esc="codigo"/> - <span t-esc="producto"/>
                                          <br/>
                                          <strong>Cantidad limitante: </strong> <span t-esc="cant_limitante"/> Kgs.
                                        </th>
                                    </tr>
                                     <tr>
                                        <td class="table-active" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:11px;vertical-align:middle; padding:5px">
                                          <strong>Ingrediente</strong>
                                        </td>
                                        <td class="table-active" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:11px;vertical-align:middle; padding:5px">
                                          <strong>C칩digo</strong>
                                        </td>
                                        <td class="table-active" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:11px;vertical-align:middle; padding:5px">
                                          <strong>Cantidad</strong>
                                        </td>
                                        <td width="18" class="table-active" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:11px;vertical-align:middle; padding:5px">
                                          <strong>Unidad</strong>
                                        </td>
                                        <td width="15" class="table-active" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:11px;vertical-align:middle; padding:5px">
                                          <strong>% F칩rmula</strong>
                                        </td>
                                    </tr>
                                    <t t-set="tot_gral" t-value="0"/>
                                    <t t-set="pct_gral" t-value="0"/>
                                    <t t-set="orden1" t-value="[]"/>
                                    <tr t-foreach="vals" t-as="l">
                                        <t t-set="orden1" t-value="orden1 + [l['orden']]"/>
                                    </tr>
                                    <t t-foreach="sorted(set(orden1))" t-as="seccion">
                                        <t t-set="tot_cantidad" t-value="0"/>
                                        <t t-set="tot_pct_form" t-value="0"/>
                                        <tr>
                                            <th class="table-secondary" colspan="6" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:10px;vertical-align:middle; padding:2px">
                                                <strong t-esc="seccion"/>
                                            </th>
                                            <tr t-foreach="vals" t-as="table_line">
                                                <t t-if="table_line['orden'] == seccion">
                                                    <td style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:9px;vertical-align:middle; padding:2px">
                                                        <t t-esc="table_line['componente']"/>
                                                    </td>
                                                    <td style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:9px;vertical-align:middle; padding:2px">
                                                        <t t-esc="table_line['cod_prov']"/>
                                                    </td>
                                                    <td style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:9px;vertical-align:middle; padding:2px">
                                                        <t t-esc="'{0:,.4f}'.format(table_line['cant_comp'])"/>
                                                        <t t-set="tot_cantidad" t-value="tot_cantidad + table_line['cant_comp']"/>
                                                    </td>
                                                    <td style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:9px;vertical-align:middle; padding:2px" align="right">
                                                        <t t-esc="table_line['unidad']"/>
                                                    </td>
                                                    <td style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:9px;vertical-align:middle; padding:2px" align="right">
                                                        <t t-esc="'{0:,.4f}'.format(table_line['pct_formula'])"/>
                                                        <t t-set="tot_pct_form" t-value="tot_pct_form + table_line['pct_formula']"/>
                                                    </td>
                                                </t>
                                            </tr>
                                        </tr>
                                        <tr>
                                            <td class="table-secondary" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:9px;vertical-align:middle; padding:2px"/>
                                            <td class="table-secondary" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:9px;vertical-align:middle; padding:2px"/>
                                            <td class="table-secondary" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:9px;vertical-align:middle;" align="right"><strong t-esc="tot_cantidad"/></td>
                                            <td class="table-secondary" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:9px;vertical-align:middle; padding:2px"/>
                                            <td class="table-secondary" style="border-style: solid;border-width: 1px;border-top: 1px solid #000000;padding-bottom:0px;padding-top:0px;font-size:9px;vertical-align:middle;" align="right"><strong t-esc="tot_pct_form"/></td>
                                        </tr>
                                    </t>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </t>
    </template>

    <record id="paperformat_custom_tabla_nutrimental_report" model="report.paperformat">
        <field name="name">Tabla Nutrimental Report</field>
        <field name="default" eval="False"/>
        <field name="format">A4</field>
        <field name="orientation">Landscape</field>
        <field name="margin_top">30</field>
        <field name="margin_bottom">20</field>
        <field name="margin_left">7</field>
        <field name="margin_right">7</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">45</field>
        <field name="dpi">90</field>
    </record>
</odoo>
